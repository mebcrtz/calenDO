{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>calenDO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
</head>
<body>
    {% include 'partials/navbar.html' %}
    <main class="container-fluid">
        {% block content %}{% endblock %}
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const editButtons = document.querySelectorAll('.edit-item-button');

            editButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const itemId = this.dataset.itemId;
                    const itemName = this.dataset.itemName;
                    const itemType = this.dataset.itemType;
                    const itemNotes = this.dataset.itemNotes;
                    const scheduleName = "{{ schedule.slug }}"; // Use the current schedule's slug

                    // Populate form fields
                    document.getElementById('editItemId').value = itemId;
                    document.getElementById('editItemName').value = itemName;
                    document.getElementById(itemType === 'event' ? 'editEvent' : 'editClass').checked = true;
                    document.getElementById('editNotes').value = itemNotes;

                    // Set form action dynamically
                    document.getElementById('editItemForm').action = `/schedule/${scheduleName}/item/${itemId}/update/`;
                });
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const selectButtons = document.querySelectorAll('.select-remove-item');
            const removeForm = document.getElementById('removeItemForm');
            const itemToRemoveName = document.getElementById('itemToRemoveName');
    
            selectButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const itemId = button.getAttribute('data-item-id');
                    const itemName = button.getAttribute('data-item-name');
                    
                    // Update the confirmation modal
                    itemToRemoveName.textContent = itemName;
    
                    // Update the form action
                    const actionUrl = `{% url 'remove_schedule_item' 0 %}`.replace('0', itemId);
                    removeForm.setAttribute('action', actionUrl);
                });
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const deleteButtons = document.querySelectorAll('.delete-schedule-button');
            const deleteForm = document.getElementById('deleteScheduleForm');
            const scheduleNameField = document.getElementById('scheduleToDeleteName');

            deleteButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const scheduleSlug = button.getAttribute('data-schedule-slug'); // Get the schedule's slug
                    const scheduleName = button.getAttribute('data-schedule-name'); // Get the schedule's name

                    // Update modal content
                    scheduleNameField.textContent = scheduleName;

                    // Update form action
                    deleteForm.setAttribute('action', `/calendar/${scheduleSlug}/delete/`);
                });
            });
        });
    </script>
</body>
</html>
